<!--Template Reference-->
{% extends 'template.html' %}

<!--Document Title-->
{% block title%}
Breakfast Bar | Dashboard
{% endblock %}

<!--Independent CSS-->
{% block css %}
<link rel="stylesheet" href="{{url_for('static', filename='css/dashboard.css')}}">
{% endblock %}

<!--Page Body-->
{% block body %}
<!-- Dashboard Section -->
<section class="container dashboard-container">

    <!-- Sidebar -->
    {% include '/dashboard/assets/customer-sidebar.html' %}

    <!-- Mobile Nav Placeholder (Hidden on Desktop) -->
    {% include '/dashboard/assets/customer-mobile-nav.html' %}

    {% if data %}
    <!-- Main Content Area -->
    <main class="dashboard-content">

        <!--Dashboard Tab-->
        {% include '/dashboard/assets/customer-dashboard.html' %}

        <!--Orders Tab-->
        {% include '/dashboard/assets/customer-orders.html' %}

        <!--Favorites Tab-->
        {% include '/dashboard/assets/customer-favorites.html' %}

        <!--Reservations Tab-->
        {% include '/dashboard/assets/customer-reservations.html' %}

        <!--Settings Tab-->
        {% include '/dashboard/assets/customer-settings.html' %}
    </main>
    {% else %}
    <h1>Your data could not be retrieved. Re-authenticate or contact support</h1>
    {% endif %}
</section>
{% endblock %}

<!--Independent JS-->
{% block js %}
<!-- Initialize Feather Icons & Tab Logic -->
<script>
    feather.replace();

    const TAB_STORAGE_KEY = "customerDashboardActiveTab";

    function switchTab(tabId) {
        // 1. Hide all tab contents
        document.querySelectorAll('.tab-content').forEach(content => {
            content.classList.remove('active');
        });

        // 2. Remove active class from sidebar & mobile links
        document.querySelectorAll('.sidebar-link, .mobile-nav-link').forEach(link => {
            link.classList.remove('active');
        });

        // 3. Show selected tab
        const selectedContent = document.getElementById(tabId);
        if (selectedContent) {
            selectedContent.classList.add('active');
            localStorage.setItem(TAB_STORAGE_KEY, tabId);
        }

        // 4. Activate matching sidebar & mobile nav links
        document.querySelectorAll('.sidebar-link, .mobile-nav-link').forEach(link => {
            const action = link.getAttribute('onclick');
            if (action && action.includes(`'${tabId}'`)) {
                link.classList.add('active');
            }
        });
    }

    // Restore last active tab on page load
    document.addEventListener('DOMContentLoaded', () => {
        const savedTab = localStorage.getItem(TAB_STORAGE_KEY) || 'dashboard';
        switchTab(savedTab);
    });
</script>
{% endblock %}