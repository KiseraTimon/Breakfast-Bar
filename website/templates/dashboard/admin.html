<!--Template Reference-->
{% extends 'template.html' %}

<!--Document Title-->
{% block title%}
Breakfast Bar | Dashboard
{% endblock %}

<!--Independent CSS-->
{% block css %}
<link rel="stylesheet" href="{{url_for('static', filename='css/admin.css')}}">
{% endblock %}

<!--Header & Sidebar-->
{% block header%}
{% endblock %}

<!--Page Body-->
{% block body %}
<!-- Dashboard Section -->
<div class="admin-wrapper">
    <!-- Sidebar -->
    {% include '/dashboard/assets/admin-sidebar.html' %}

    <main class="main-content">
        <!--Header-->
        {% include '/dashboard/assets/admin-header.html' %}

        <!--Overview Tab-->
        {% include '/dashboard/assets/admin-overview.html' %}

        <!--Orders Tab-->
        {% include '/dashboard/assets/admin-orders.html' %}

        <!--Menu Tab-->
        {% include '/dashboard/assets/admin-menu.html' %}

        <!--Customers Tab-->
        {% include '/dashboard/assets/admin-customers.html' %}

        <!--Analytics Tab-->
        {% include '/dashboard/assets/admin-analytics.html' %}
    </main>

</div>
{% endblock %}

<!--Footer-->
{% block footer %}
{% endblock %}

<!--Independent JS-->
{% block js %}
<!-- Initialize Feather Icons & Tab Logic -->
<script>
    feather.replace();

    const TAB_STORAGE_KEY = "adminDashboardActiveTab";

    function navigate(tabId, clickedItem = null) {
        document.querySelectorAll('.tab-screen').forEach(screen => {
            screen.classList.remove('active');
        });

        const selectedScreen = document.getElementById(tabId);
        if (selectedScreen) {
            selectedScreen.classList.add('active');
            localStorage.setItem(TAB_STORAGE_KEY, tabId);
        }

        document.querySelectorAll('.nav-item').forEach(item => {
            item.classList.remove('active');
        });

        if (clickedItem) {
            clickedItem.classList.add('active');
        } else {
            document.querySelectorAll('.nav-item').forEach(item => {
                const action = item.getAttribute('onclick');
                if (action && action.includes(`'${tabId}'`)) {
                    item.classList.add('active');
                }
            });
        }

        const titles = {
            overview: 'Main Dashboard',
            orders: 'Order Management',
            menu: 'Menu Items',
            customers: 'Customers',
            analytics: 'Analytics'
        };

        document.getElementById('header-title').textContent =
            titles[tabId] || 'Dashboard';
    }

    // Run as early as possible
    const savedTab = localStorage.getItem(TAB_STORAGE_KEY) || 'overview';
    document.addEventListener('DOMContentLoaded', () => {
        navigate(savedTab);
    });
</script>
{% endblock %}